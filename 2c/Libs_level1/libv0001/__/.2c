//******************************************************************************************
//Начальная инициализация модуля - процедура вызывается в режиме Конфигуратора и Предприятия
//******************************************************************************************
Процедура ИнициализацияМодуля()
	//Подписка на предопределенные события:
	ПодписатьсяНаСобытие("ПриВыбореШаблона","ОбработкаВыборШаблона");
	ПодписатьсяНаСобытие("ПриКонтекстнойПомощи","ОбработкаКонтекстнойПомощи");
	

	Панель=СоздатьОбъект("ПанельИнструментов");
	Панель=Панель.ПолучитьГлавнуюПанель();
	Панель.Добавить(612 ,"ЗапуститьБагРепортер",0,"","Сообщить об ошибке","Сообщить об ошибке...");
	
КонецПроцедуры

//******************************************************************************************
//Предопределенные процедуры и функции в режиме Предприятия
//******************************************************************************************
Процедура ПриНачалеРаботыСистемы()

КонецПроцедуры

Процедура ПриЗавершенииРаботыСистемы()

КонецПроцедуры 


//******************************************************************************************
//Предопределенные процедуры и функции в режиме Конфигуратора
//******************************************************************************************
Процедура ПриНачалеРаботыКонфигуратора()
	УстановитьЗаголовокПриложения("Конфигуратор : ");

	Панель=СоздатьОбъект("ПанельИнструментов");
	Панель=Панель.ПолучитьГлавнуюПанель();
	Панель.Добавить(203 ,"РедактированиеТекущегоМодуля",0,"","РедактированиеТекущегоМодуля","РедактированиеТекущегоМодуля...");
	Панель.Добавить(365 ,"ПерейтиКСтроке",0,"","Перейти к строке","Перейти к строке...");
КонецПроцедуры 


Процедура ПриЗавершенииРаботыКонфигуратора()

КонецПроцедуры 






//___________________________________________________________________________________________
Функция ВыборШаблона(ПозицияХ,ПозицияУ,Текст,СтрПоиска,СтрНачало,СтрКонец,СтрУдаления,СтрВставки,ТипШаблона=0)
	СтрУдаления=Врег(СтрПоиска);
	ТекстДл=Прав(Текст,СтрДлина(СтрУдаления)+1);
	ТекстКр=Прав(Текст,СтрДлина(СтрУдаления));
	Если СтрУдаления=ТекстДл Или (СтрУдаления=ТекстКр И КодСимв(Сред(ТекстДл,1,1))<65 И Сред(ТекстДл,1,1)<>".")Тогда
		Если (ТипШаблона=0)ИЛИ(ТипШаблона=2) Тогда
			Имя="";
			Рез=ВвестиСтроку(Имя);
			Если Рез=1 Тогда
				Если ПустоеЗначение(Имя)=1 Тогда
					ПозицияУ=0;
					Если Лев(СтрНачало,10)="//________" Тогда
						ПозицияУ=1;
					Иначе
						ПозицияХ=СтрДлина(СтрНачало);
					КонецЕсли
					
				КонецЕсли
				СтрВставки=СтрНачало+Имя+СтрКонец;
				Если ТипШаблона=2 Тогда
					 СтрВставки=СтрВставки+"//"+Имя+Симв(13);
				КонецЕсли
				Возврат 1;
			КонецЕсли;
		ИначеЕсли ТипШаблона=1 Тогда
			//выбираем тип объекта
			МассивРезультата=СоздатьОбъект("Массив");
			Конт=МассивРезультата;
			ОткрытьФормуМодально("Общие формы/МодульТекстовогоРедактора/Выбор типов объектов",Конт);
			Тип=МассивРезультата["Результат"];
			Если ПустоеЗначение(Тип)=0 Тогда
				СтрВставки=СтрНачало+Тип+СтрКонец;
				Возврат 1;
			КонецЕсли
		КонецЕсли
	КонецЕсли;
КонецФункции

//___________________________________________________________________________________________
Функция ПриВыбореШаблона(Текст,СтрУдаления,СтрВставки,ПозицияХ,ПозицияУ)
	СтрЛинии="//___________________________________________________________________________________________"+Симв(13);

	Текст=(ВРЕГ(Текст));
	Если ВыборШаблона(ПозицияХ,ПозицияУ,Текст,"Проц",СтрЛинии+"Процедура ","()"+Симв(13)+Симв(13)+"КонецПроцедуры",СтрУдаления,СтрВставки,2) Тогда
		Возврат 1;
	ИначеЕсли ВыборШаблона(ПозицияХ,ПозицияУ,Текст,"Процедура","Процедура ","()"+Симв(13)+Симв(13)+"КонецПроцедуры",СтрУдаления,СтрВставки,2) Тогда
		Возврат 1;
	ИначеЕсли ВыборШаблона(ПозицияХ,ПозицияУ,Текст,"Функ",СтрЛинии+"Функция ","()"+Симв(13)+Симв(13)+"КонецФункции",СтрУдаления,СтрВставки,2) Тогда
		Возврат 1;
	ИначеЕсли ВыборШаблона(ПозицияХ,ПозицияУ,Текст,"Функция",СтрЛинии+"Функция ","()"+Симв(13)+Симв(13)+"КонецФункции",СтрУдаления,СтрВставки,2) Тогда
		Возврат 1;
	ИначеЕсли ВыборШаблона(ПозицияХ,ПозицияУ,Текст,"Если","Если "," Тогда"+Симв(13)+Симв(13)+"КонецЕсли"+Симв(13),СтрУдаления,СтрВставки) Тогда
		Возврат 1;
	ИначеЕсли ВыборШаблона(ПозицияХ,ПозицияУ,Текст,"Пока","Пока "," Цикл"+Симв(13)+Симв(13)+"КонецЦикла"+Симв(13),СтрУдаления,СтрВставки) Тогда
		Возврат 1;
	ИначеЕсли ВыборШаблона(ПозицияХ,ПозицияУ,Текст,"Для","Для А=1 По "," Цикл"+Симв(13)+Симв(13)+"КонецЦикла"+Симв(13),СтрУдаления,СтрВставки) Тогда
		Возврат 1;
	ИначеЕсли ВыборШаблона(ПозицияХ,ПозицияУ,Текст,"Созд","СоздатьОбъект(""",""");",СтрУдаления,СтрВставки,1) Тогда
		Возврат 1;
	ИначеЕсли ВыборШаблона(ПозицияХ,ПозицияУ,Текст,"СоздатьОбъект","СоздатьОбъект(""",""");",СтрУдаления,СтрВставки,1) Тогда
		Возврат 1;

	//lat:		
	ИначеЕсли ВыборШаблона(ПозицияХ,ПозицияУ,Текст,"ghjw",СтрЛинии+"Процедура ","()"+Симв(13)+Симв(13)+"КонецПроцедуры",СтрУдаления,СтрВставки,2) Тогда
		Возврат 1;
	ИначеЕсли ВыборШаблона(ПозицияХ,ПозицияУ,Текст,"aeyr",СтрЛинии+"Функция ","()"+Симв(13)+Симв(13)+"КонецФункции",СтрУдаления,СтрВставки,2) Тогда
		Возврат 1;
	ИначеЕсли ВыборШаблона(ПозицияХ,ПозицияУ,Текст,"tckb","Если "," Тогда"+Симв(13)+Симв(13)+"КонецЕсли"+Симв(13),СтрУдаления,СтрВставки) Тогда
		Возврат 1;
	ИначеЕсли ВыборШаблона(ПозицияХ,ПозицияУ,Текст,"gjrf","Пока "," Цикл"+Симв(13)+Симв(13)+"КонецЦикла"+Симв(13),СтрУдаления,СтрВставки) Тогда
		Возврат 1;
	ИначеЕсли ВыборШаблона(ПозицияХ,ПозицияУ,Текст,"Lkz","Для А=1 По "," Цикл"+Симв(13)+Симв(13)+"КонецЦикла"+Симв(13),СтрУдаления,СтрВставки) Тогда
		Возврат 1;
	ИначеЕсли ВыборШаблона(ПозицияХ,ПозицияУ,Текст,"cjpl","СоздатьОбъект(""",""");",СтрУдаления,СтрВставки,1) Тогда
		Возврат 1;
		
	КонецЕсли;
	Возврат 0;
КонецФункции

//___________________________________________________________________________________________
//Обработка предопределенного в 2С события - "ПриВыбореШаблона".
//Вызывается при нажатии пробела или Enter-а при редактировании программного модуля
//при условии редактирования не комментария и не строки константы
//___________________________________________________________________________________________
Процедура ОбработкаВыборШаблона(Результат,Текст,СтрУдаления,СтрВставки,ПозицияХ,ПозицияУ)
	Результат=ПриВыбореШаблона(Текст,СтрУдаления,СтрВставки,ПозицияХ,ПозицияУ);
КонецПроцедуры



//___________________________________________________________________________________________
//Обработка предопределенного в 2С события - "ПриКонтекстнойПомощи".
//Вызывается при нажатии F1 при редактировании программного модуля
//___________________________________________________________________________________________
Процедура ОбработкаКонтекстнойПомощи(Результат,Текст)
	Перем Конт;
	ОткрытьФорму("Общие формы/Синтаксис-помощник/Синтаксис-помощник",Конт,,"Синтаксис-помощник");
	Конт.ПоказатьЭлемент(Текст);
КонецПроцедуры//ОбработкаКонтекстнойПомощи




//___________________________________________________________________________________________
Процедура УстановитьЗаголовокПриложения(Префикс)
	Для А=1 По КоличествоАргументовПрограммы() Цикл
		Стр=ЗначениеАргументаПрограммы(А);
		Если ВРЕГ(Лев(Стр,6))="/TITLE" Тогда
			ЗаголовокСистемы(Префикс+Сред(Стр,7));
		КонецЕсли
	КонецЦикла
КонецПроцедуры




//___________________________________________________________________________________________
Процедура РедактированиеТекущегоМодуля()
	Стр=ПолучитьТекстАктивногоОкна();
	Рез=УстановитьТекстАктивногоОкна(Стр+Симв(13)+"//Это тест!!",1);
	ПерейтиКСтрокеАктивногоОкна(100000);//переход в конец
КонецПроцедуры//РедактированиеТекущегоМодуля

//___________________________________________________________________________________________
Процедура ПерейтиКСтроке()
	Ном="";
	ВвестиСтроку(Ном,"Введите номер строки",10);
	Ном=Число(Ном);
	Если Ном>0 Тогда
		 ПерейтиКСтрокеАктивногоОкна(Ном);
	КонецЕсли
КонецПроцедуры//ПерейтиКСтроке


//___________________________________________________________________________________________
Процедура ЗапуститьБагРепортер()
	ОткрытьФорму("Общие формы/СовместнаяРазработка/Баг-Репорт");
КонецПроцедуры//ЗапуститьБагРепортер
